import time
import pyfiglet

from ip_locate import ip_checker
from scan import subnet_ip_scan

# Some Constants
SUBNET_MASK = '24'
STEP_PAUSE = 1.5

kali_ip_address = ip_checker()
time.sleep(STEP_PAUSE)

hosts_list = subnet_ip_scan(ip=kali_ip_address, mask=SUBNET_MASK, keep_self=False, verbose=True)
time.sleep(STEP_PAUSE)
    
        
print(hosts_list)

banner = pyfiglet.figlet_format('Expoit pfSense BACKDOOR')
print(banner)
print("=="*40)
time.sleep(10)

lan_hosts_list = [('10.0.0.1', 'up'),
                 ('10.6.6.1', 'up'),
                 ('10.80.80.1', 'up')]

print(lan_hosts_list)      

for i, (lan_hosts_ip, lan_hosts_status) in enumerate(lan_hosts_list):
    subnet_hosts_list = subnet_ip_scan(ip=lan_hosts_ip, mask=SUBNET_MASK)
    print("subnet "+ str(i) + " host ip addresses:")
    print(subnet_hosts_list)

           
