import nmap 
import socket
import pyfiglet

SUBNET_MASK = '24'

def subnet_ip_scan(ip='192.168.0.1', mask='24', keep_self=False, verbose=True, banner=True):
    
    if banner:
        banner = pyfiglet.figlet_format('Subnet Hosts Scan')
        print(banner)
        print("=="*40)
    
    nm = nmap.PortScanner()
    masked_subnet_ip = ip + '/' + mask
    nm.scan(hosts=masked_subnet_ip, arguments='-n -sP -PE -PA21,23,80,3389')
    hosts_list = [(x, nm[x]['status']['state']) for x in nm.all_hosts()]
    if verbose:
        for i, (host, status) in enumerate(hosts_list): 
            if not keep_self and host == ip:
                hosts_list.pop(i)        
            print(host, status)
      
    return hosts_list